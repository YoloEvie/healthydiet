import{_ as F}from"./home-AI-BHeAdNGk.js";import{a as N}from"./axios-NIGUFBhG.js";import{_ as T,u as A}from"./index-bPO5O26h.js";import{r as d,v as P,k as h,e as u,o as m,g as t,f as e,j as r,z as i,u as _,M as p,F as V,N as Y,H as k}from"./element-plus-BAXMo5c4.js";const j="/healthydiet/assets/mine-xiaoxi-DV33oro2.png",L="/healthydiet/assets/mine-article-DYilE0KO.png",O="/healthydiet/assets/mine-good-DBvT_BOB.png",U={class:"personal-information"},$={class:"left"},z=["src"],G={key:1,src:"https://p3.hippopx.com/preview/723/720/forests-mist-autumn-colors-peaceful-forest-vibrant-autumn-soft-daylight-nature-s-beauty-misty-forest-autumn-forest-natural-scenery.jpg",alt:"默认头像"},H={class:"right"},K={class:"name-box"},R={class:"number"},q={class:"other"},J={class:"age"},Q={class:"sex"},W={class:"action-area card"},X={class:"personal-icon icon"},Z={class:"customer-service set"},ee={class:"customer-service-icon icon"},se={class:"feedback-icon icon"},te={__name:"PersonalCenter",setup(oe){const c=A(),l=d({}),g=d(!0),f=d(""),y=()=>{const o=localStorage.getItem("user_id");return o?o.replace(/^"/,"").replace(/"$/,""):null},x=o=>({male:"男",female:"女"})[o]||"未设置",b=o=>{if(!o)return"未设置";try{const s=new Date(o);if(isNaN(s.getTime()))return"重新设置年龄";const a=new Date;let n=a.getFullYear()-s.getFullYear();const v=a.getMonth()-s.getMonth();return(v<0||v===0&&a.getDate()<s.getDate())&&n--,n>=0?n+"岁":"重新设置年龄"}catch(s){return console.error("计算年龄出错:",s),"重新设置年龄"}},C=async()=>{const o=y();if(!o){f.value="未找到用户信息，请先登录",g.value=!1;return}try{const s=await N.get(`http://localhost:3000/api/users/${o}`);l.value=s.data}catch(s){console.error("获取用户信息失败:",s),f.value="获取用户信息失败，请稍后重试"}finally{g.value=!1}},I=()=>{c.push("/mine/personalset")},B=()=>{Y.confirm("确定要退出登录吗？","退出确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{w(),k.success("已成功退出登录")}).catch(()=>{k.info("已取消退出")})},M=()=>{c.push("/mine/feedback")},w=()=>{localStorage.removeItem("role"),localStorage.removeItem("user_id"),localStorage.removeItem("username"),c.push("/")},D=()=>{c.push("/mine/message")},E=()=>{c.push("/mine/post")},S=()=>{c.push("/mine/like")};return P(()=>{C()}),(o,s)=>{const a=h("el-card"),n=h("el-icon");return m(),u(V,null,[t(a,{class:"card"},{default:r(()=>[e("div",U,[e("div",$,[l.value.avatar_url?(m(),u("img",{key:0,src:l.value.avatar_url,alt:"用户头像",class:"avatar"},null,8,z)):(m(),u("img",G))]),e("div",H,[e("div",K,[e("p",null,"用户名："+i(l.value.username||"未设置"),1)]),e("div",R,[e("p",null,"账号："+i(l.value.phone_number||"未知"),1)]),e("div",q,[e("p",J,"年龄："+i(b(l.value.birth_date)),1),e("p",Q,"性别："+i(x(l.value.gender)),1)])])])]),_:1}),e("div",W,[t(a,{class:"action-card",onClick:o.handleEditAI},{default:r(()=>s[0]||(s[0]=[e("div",{class:"action-item"},[e("div",{class:"card-img"},[e("img",{src:F,alt:""})]),e("h2",null,"AI营养师")],-1)])),_:1,__:[0]},8,["onClick"]),t(a,{class:"action-card",onClick:D},{default:r(()=>s[1]||(s[1]=[e("div",{class:"action-item"},[e("div",{class:"card-img"},[e("img",{src:j,alt:""})]),e("h2",null,"消息通知")],-1)])),_:1,__:[1]}),t(a,{class:"action-card",onClick:E},{default:r(()=>s[2]||(s[2]=[e("div",{class:"action-item"},[e("div",{class:"card-img"},[e("img",{src:L,alt:""})]),e("h2",null,"我的帖子")],-1)])),_:1,__:[2]}),t(a,{class:"action-card",onClick:S},{default:r(()=>s[3]||(s[3]=[e("div",{class:"action-item"},[e("div",{class:"card-img"},[e("img",{src:O,alt:""})]),e("h2",null,"我的喜欢")],-1)])),_:1,__:[3]})]),t(a,{class:"card"},{default:r(()=>[e("div",{class:"personal-setting set",onClick:I},[s[4]||(s[4]=e("p",{class:"personal-text"},"账号设置",-1)),e("div",X,[t(n,null,{default:r(()=>[t(_(p),{color:"var(--el-text-color-primary)"})]),_:1})])]),e("div",Z,[s[5]||(s[5]=e("p",{class:"customer-service-text"},"智能客服",-1)),e("div",ee,[t(n,null,{default:r(()=>[t(_(p),{color:"var(--el-text-color-primary)"})]),_:1})])]),e("div",{class:"feedback set",onClick:M,style:{border:"0"}},[s[6]||(s[6]=e("p",{class:"feedback-text"},"建议与反馈",-1)),e("div",se,[t(n,null,{default:r(()=>[t(_(p),{color:"var(--el-text-color-primary)"})]),_:1})])])]),_:1}),t(a,{class:"card out",onClick:B},{default:r(()=>s[7]||(s[7]=[e("p",{class:"out-text"},"退出登录",-1)])),_:1,__:[7]})],64)}}},ce=T(te,[["__scopeId","data-v-0e3cdbdd"]]);export{ce as default};
