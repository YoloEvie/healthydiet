import{_ as R,u as D}from"./index-CMQRH6kX.js";import{a as F}from"./axios-NIGUFBhG.js";import{r as b,b as V,k as s,e as M,o as P,g as r,j as l,l as d,f as u,G as g}from"./element-plus-DirRqt2a.js";const C={class:"registration-container"},E={class:"card-footer"},B={__name:"Register",setup(N){const c=D(),m=b(null),p=b(!1),o=V({phone:"",username:"",gender:1,birthday:"",password:"",confirmPassword:"",agree:!1}),w=V({phone:[{required:!0,message:"请输入手机号码",trigger:"blur"},{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号码",trigger:"blur"}],username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:2,max:20,message:"用户名长度在2-20个字符之间",trigger:"blur"}],gender:[{required:!0,message:"请选择性别",trigger:"change"}],birthday:[{required:!0,message:"请选择出生日期",trigger:"change"}],password:[{required:!0,message:"请设置密码",trigger:"blur"},{min:6,max:20,message:"密码长度在6-20个字符之间",trigger:"blur"}],confirmPassword:[{required:!0,message:"请确认密码",trigger:"blur"},{validator:(i,e,a)=>{e!==o.password?a(new Error("两次输入的密码不一致")):a()},trigger:"blur"}],agree:[{validator:(i,e,a)=>{e?a():a(new Error("请阅读并同意用户协议和隐私政策"))},trigger:"change"}]}),y=async()=>{m.value.validate(async i=>{if(i){p.value=!0;try{const e={phone_number:o.phone,username:o.username,gender:o.gender,birth_date:o.birthday,password_hash:o.password},a=await F.post("http://localhost:3000/api/users",e);g.success("注册成功！即将跳转到登录页"),setTimeout(()=>{c.push("/login")},1500)}catch(e){e.response?g.error(e.response.data.message||"注册失败，请重试"):g.error("网络错误，请检查连接")}finally{p.value=!1}}})},v=()=>{m.value.resetFields()};return(i,e)=>{const a=s("el-input"),n=s("el-form-item"),_=s("el-radio"),x=s("el-radio-group"),k=s("el-date-picker"),h=s("el-checkbox"),f=s("el-button"),Y=s("el-form"),U=s("router-link"),q=s("el-card");return P(),M("div",C,[r(q,{class:"registration-card",style:{"max-width":"600px"}},{header:l(()=>e[7]||(e[7]=[u("div",{class:"card-header"},[u("span",null,[u("b",null,"欢迎来到悦然食光！")])],-1)])),footer:l(()=>[u("div",E,[u("span",null,[e[14]||(e[14]=d("已有账号？")),r(U,{to:"/login"},{default:l(()=>e[13]||(e[13]=[d("立即登录")])),_:1,__:[13]})])])]),default:l(()=>[r(Y,{ref_key:"registerFormRef",ref:m,model:o,rules:w,"label-width":"120px",class:"register-form"},{default:l(()=>[r(n,{label:"手机号码",prop:"phone"},{default:l(()=>[r(a,{modelValue:o.phone,"onUpdate:modelValue":e[0]||(e[0]=t=>o.phone=t),placeholder:"请输入11位手机号码"},null,8,["modelValue"])]),_:1}),r(n,{label:"用户名称",prop:"username"},{default:l(()=>[r(a,{modelValue:o.username,"onUpdate:modelValue":e[1]||(e[1]=t=>o.username=t),placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1}),r(n,{label:"用户性别",prop:"gender"},{default:l(()=>[r(x,{modelValue:o.gender,"onUpdate:modelValue":e[2]||(e[2]=t=>o.gender=t)},{default:l(()=>[r(_,{label:1},{default:l(()=>e[8]||(e[8]=[d("男")])),_:1,__:[8]}),r(_,{label:2},{default:l(()=>e[9]||(e[9]=[d("女")])),_:1,__:[9]})]),_:1},8,["modelValue"])]),_:1}),r(n,{label:"出生日期",prop:"birthday"},{default:l(()=>[r(k,{modelValue:o.birthday,"onUpdate:modelValue":e[3]||(e[3]=t=>o.birthday=t),type:"date",placeholder:"选择出生日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1}),r(n,{label:"设置密码",prop:"password"},{default:l(()=>[r(a,{type:"password",modelValue:o.password,"onUpdate:modelValue":e[4]||(e[4]=t=>o.password=t),placeholder:"请设置密码"},null,8,["modelValue"])]),_:1}),r(n,{label:"确认密码",prop:"confirmPassword"},{default:l(()=>[r(a,{type:"password",modelValue:o.confirmPassword,"onUpdate:modelValue":e[5]||(e[5]=t=>o.confirmPassword=t),placeholder:"请再次输入密码"},null,8,["modelValue"])]),_:1}),r(n,null,{default:l(()=>[r(h,{modelValue:o.agree,"onUpdate:modelValue":e[6]||(e[6]=t=>o.agree=t)},{default:l(()=>e[10]||(e[10]=[d("我已阅读并同意用户协议和隐私政策")])),_:1,__:[10]},8,["modelValue"])]),_:1}),r(n,null,{default:l(()=>[r(f,{type:"primary",onClick:y,loading:p.value},{default:l(()=>e[11]||(e[11]=[d("立即注册")])),_:1,__:[11]},8,["loading"]),r(f,{onClick:v},{default:l(()=>e[12]||(e[12]=[d("重置")])),_:1,__:[12]})]),_:1})]),_:1},8,["model","rules"])]),_:1})])}}},I=R(B,[["__scopeId","data-v-c4d84d3d"]]);export{I as default};
