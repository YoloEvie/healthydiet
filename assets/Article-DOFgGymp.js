import{d as O,r as u,t as U,e as n,g as t,f as a,v as h,j as s,k as o,l as m,y as i,u as y,S as G,E as H,A as S,F as w,z as C,o as l,x}from"./element-plus-DirRqt2a.js";import{a as K,u as Q,_ as W}from"./index-CMQRH6kX.js";import{a as X}from"./axios-NIGUFBhG.js";const Y={class:"main"},Z={class:"action-bar"},ee={key:0,class:"article-photos"},te={class:"image-placeholder"},se={class:"article-content"},ae={class:"article-title"},le={class:"article-summary"},oe={key:0,class:"article-ingredients"},ne={key:1,class:"article-steps"},ie={class:"step-content"},re={key:2,class:"article-tips"},ce=O({__name:"Article",setup(ue){const g=K(),I=Q(),d=u(g.params.id),v=u(g.query.recipeId),b=u(g.query.recipeName),k=u(""),$=u(""),r=u({ingredients:[],steps:[],tips:""}),f=u([]),A=X.create({baseURL:"http://localhost:3000/api",timeout:5e3,headers:{"Content-Type":"application/json"}}),V=async()=>{try{const e=(await A.get(`/articles/${d.value}`)).data;console.log(e),k.value=e.title,$.value=e.summary,e.content&&(r.value=JSON.parse(e.content)),await P()}catch(c){console.error("获取文章详情失败:",c)}},P=async()=>{try{const c=await A.get(`/article-photos/article/${d.value}`);f.value=c.data}catch(c){console.error("获取文章照片失败:",c)}},R=()=>{I.push({path:`/articles/edit/${d.value}`,query:{recipeId:v.value,recipeName:b.value}})},T=()=>{I.push({path:`/articles/photos/edit/${d.value}`,query:{recipeId:v.value,recipeName:b.value}})};return U(()=>{d.value&&V()}),(c,e)=>{const q=o("el-breadcrumb-item"),j=o("el-breadcrumb"),N=o("el-icon"),B=o("el-button"),D=o("el-image"),F=o("el-list-item"),L=o("el-list"),E=o("el-card"),z=o("el-timeline-item"),J=o("el-timeline");return l(),n("div",Y,[t(j,{"separator-icon":y(G)},{default:s(()=>[t(q,{to:v.value?{path:`/cookbooks/view/${v.value}`}:{path:"/mine/post"}},{default:s(()=>[m(i(b.value||"我的帖子"),1)]),_:1},8,["to"]),t(q,null,{default:s(()=>[m(i(k.value),1)]),_:1})]),_:1},8,["separator-icon"]),a("div",Z,[t(B,{type:"primary",onClick:R},{default:s(()=>[t(N,null,{default:s(()=>[t(y(H))]),_:1}),e[0]||(e[0]=m(" 编辑内容 "))]),_:1,__:[0]}),t(B,{type:"primary",onClick:T},{default:s(()=>[t(N,null,{default:s(()=>[t(y(S))]),_:1}),e[1]||(e[1]=m(" 编辑图片 "))]),_:1,__:[1]})]),f.value.length>0?(l(),n("div",ee,[(l(!0),n(w,null,C(f.value,(_,p)=>(l(),x(D,{key:p,src:_.image_url,"preview-src-list":f.value.map(M=>M.image_url),class:"article-photo",fit:"contain"},{placeholder:s(()=>[a("div",te,[t(N,null,{default:s(()=>[t(y(S))]),_:1})])]),_:2},1032,["src","preview-src-list"]))),128))])):h("",!0),a("div",se,[a("h1",ae,i(k.value),1),a("div",le,[e[2]||(e[2]=a("h2",null,"简介",-1)),a("p",null,i($.value),1)]),r.value?.ingredients?.length?(l(),n("div",oe,[e[3]||(e[3]=a("h2",null,"食材准备",-1)),t(L,{class:"ingredient-list"},{default:s(()=>[(l(!0),n(w,null,C(r.value.ingredients,(_,p)=>(l(),x(F,{key:p,class:"ingredient-item"},{default:s(()=>[m(i(_.name)+"："+i(_.amount),1)]),_:2},1024))),128))]),_:1})])):h("",!0),r.value?.steps?.length?(l(),n("div",ne,[e[4]||(e[4]=a("h2",null,"制作步骤",-1)),t(J,null,{default:s(()=>[(l(!0),n(w,null,C(r.value.steps,(_,p)=>(l(),x(z,{key:p,timestamp:`步骤 ${p+1}`},{default:s(()=>[t(E,null,{default:s(()=>[a("div",ie,i(_.content),1)]),_:2},1024)]),_:2},1032,["timestamp"]))),128))]),_:1})])):h("",!0),r.value?.tips?(l(),n("div",re,[e[5]||(e[5]=a("h2",null,"小贴士",-1)),t(E,{class:"tips-card"},{default:s(()=>[a("p",null,i(r.value.tips),1)]),_:1})])):h("",!0)])])}}}),me=W(ce,[["__scopeId","data-v-f4efebb1"]]);export{me as default};
