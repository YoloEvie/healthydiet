import{_ as b,u as F}from"./index-DAIr6xV4.js";import{e as c,o as r,f as o,d as T,q as G,r as g,t as S,v as R,x as A,y as w,l as $,j as k,g as u,F as D,z as B,k as h,u as H}from"./element-plus-DirRqt2a.js";import{_ as N}from"./home-AI-BHeAdNGk.js";import{a as I}from"./axios-NIGUFBhG.js";import{A as L}from"./ArticleCard-BGw7Nb_A.js";const z={};function E(x,s){return r(),c("header",null,s[0]||(s[0]=[o("div",{class:"banner"},null,-1)]))}const P=b(z,[["render",E],["__scopeId","data-v-b3a6e002"]]),U="/healthydiet/assets/home-dingzhi-DSzYPD5t.png",Y="/healthydiet/assets/home-shequ-iusb3PaY.png",q={class:"tool"},j={class:"tool-box"},Z=T({__name:"ToolSection",emits:["go-to-cookbooks","go-to-forum"],setup(x){return(s,n)=>(r(),c("div",q,[n[5]||(n[5]=o("h2",null,"特色功能",-1)),o("div",j,[o("div",{class:"tool-item",onClick:n[0]||(n[0]=d=>s.$emit("go-to-cookbooks"))},n[2]||(n[2]=[o("div",{class:"tool-area"},[o("div",{class:"tool-icon"},[o("img",{src:U,alt:"定制食谱图标"})]),o("h3",null,"定制食谱")],-1),o("p",{class:"tool-info"},"随时随地定制专属于自己的个性化食谱。",-1)])),o("div",{class:"tool-item",onClick:n[1]||(n[1]=d=>s.$emit("go-to-forum"))},n[3]||(n[3]=[o("div",{class:"tool-area"},[o("div",{class:"tool-icon"},[o("img",{src:Y,alt:"社区交流图标"})]),o("h3",null,"社区交流")],-1),o("p",{class:"tool-info"},"与志同道合的健康爱好者交流经验，分享食谱。",-1)])),n[4]||(n[4]=G('<div class="tool-item" data-v-1e1ec787><div class="tool-area" data-v-1e1ec787><div class="tool-icon" data-v-1e1ec787><img src="'+N+'" alt="AI营养师图标" data-v-1e1ec787></div><h3 data-v-1e1ec787>AI营养师</h3></div><p class="tool-info" data-v-1e1ec787> 随时咨询专业AI营养师，获取个性化的饮食建议和健康指导。 </p></div>',1))])]))}}),J=b(Z,[["__scopeId","data-v-1e1ec787"]]),K="/healthydiet/assets/home-tip-BmZVf37G.png",O={},Q={class:"tip"};function W(x,s){return r(),c("div",Q,s[0]||(s[0]=[o("h2",null,"健康小贴士",-1),o("div",{class:"tip-box"},[o("div",{class:"tip-icon"},[o("img",{src:K,alt:"健康小贴士图标"})]),o("p",null,"每天饮用足够的水对于身体健康至关重要。建议每天喝8杯水，大约2升。")],-1)]))}const X=b(O,[["render",W],["__scopeId","data-v-a585a20b"]]),tt={class:"food-tips"},et={class:"time"},ot={key:0,class:"loading"},st={key:1,class:"error-message"},nt={key:2,class:"food-box"},at=T({__name:"TodayRecipe",props:{currentDate:{}},setup(x){const s=g([]),n=g(null),d=g({}),y=g(!0),l=g(""),m=()=>{const e=localStorage.getItem("user_id");return!e||e.trim()===""?null:e.replace(/^["']|["']$/g,"").trim()},i=async e=>{try{const t=await I.get(`http://localhost:3000/api/users/${e}`);n.value=t.data}catch(t){console.error("获取用户信息失败:",t)}},_=async e=>{try{const t=await I.get(`http://localhost:3000/api/article-photos/article/${e}`);t.data&&t.data.length>0&&(d.value[e]=t.data[0].image_url)}catch(t){console.error(`获取文章${e}图片失败`,t)}},v=(e,t)=>{const a=[...e].sort(()=>.5-Math.random());return a.slice(0,Math.min(t,a.length))},C=async()=>{try{y.value=!0,l.value="";const e=m();if(!e){l.value="未检测到用户信息，请先登录";return}await i(e);const t=await I.get(`http://localhost:3000/api/articles/author/${e}`);if(!Array.isArray(t.data))throw new Error("获取的数据格式不正确");const a=t.data.filter(f=>f&&f.status==="published"&&f.type&&f.type.toLowerCase()==="recipe");for(const f of a)f.cover_image||await _(f.article_id);s.value=v(a,3)}catch(e){console.error("获取用户食谱失败:",e),I.isAxiosError(e)?e.response?.status===401?l.value="登录状态已过期，请重新登录":e.response?.status===404?l.value="未找到您的食谱数据":navigator.onLine?l.value=`获取失败：${e.response?.data?.message||"服务器错误"}`:l.value="网络连接异常，请检查网络":l.value="获取您的食谱失败，请稍后重试"}finally{y.value=!1}};return S(()=>{C()}),(e,t)=>{const a=h("el-button"),f=h("router-link"),M=h("el-card"),V=h("el-empty");return r(),c("div",tt,[t[5]||(t[5]=o("h2",null,"今日食谱",-1)),o("p",et,w(e.currentDate),1),y.value?(r(),c("div",ot)):R("",!0),l.value?(r(),c("div",st,[$(w(l.value)+" ",1),l.value.includes("未检测到用户信息")||l.value.includes("登录状态已过期")?(r(),A(a,{key:0,type:"primary",size:"small",onClick:t[0]||(t[0]=p=>e.$emit("go-to-login"))},{default:k(()=>t[2]||(t[2]=[$(" 去登录 ")])),_:1,__:[2]})):R("",!0)])):s.value.length>0?(r(),c("div",nt,[(r(!0),c(D,null,B(s.value,p=>(r(),A(L,{class:"article-card",key:p.article_id,"image-url":p.cover_image||d.value[p.article_id]||"https://picsum.photos/400/200",title:p.title,excerpt:p.summary||"暂无简介","author-name":n.value?.username||"未知用户","author-avatar":n.value?.avatar_url||"https://picsum.photos/100/100",category:p.type,likes:p.likes_count,comments:p.comments_count,onClick:_t=>e.$emit("article-click",p.article_id)},null,8,["image-url","title","excerpt","author-name","author-avatar","category","likes","comments","onClick"]))),128)),u(M,{class:"food-tip more-food-tip"},{default:k(()=>[o("h3",null,[u(f,{to:"/cookbooks"},{default:k(()=>t[3]||(t[3]=[$("查看更多食谱")])),_:1,__:[3]})])]),_:1})])):(r(),A(V,{key:3,description:"暂无您的食谱数据"},{default:k(()=>[u(a,{type:"primary",onClick:t[1]||(t[1]=p=>e.$emit("go-to-create-recipe"))},{default:k(()=>t[4]||(t[4]=[$(" 创建我的第一个食谱文章 ")])),_:1,__:[4]})]),_:1}))])}}}),rt=b(at,[["__scopeId","data-v-8043724c"]]),lt={class:"hot-recommend"},it={key:0,class:"loading"},ct={key:1,class:"error-message"},ut={key:2,class:"hot-recommend-list"},dt=T({__name:"HotRecommend",setup(x){const s=g([]),n=g(!0),d=g(""),y=(m,i)=>{const _=[...m].sort(()=>.5-Math.random());return _.slice(0,Math.min(i,_.length))},l=async()=>{try{n.value=!0;const i=(await I.get("http://localhost:3000/api/articles")).data.filter(_=>_.status==="published");s.value=y(i,7),d.value=""}catch(m){console.error("获取热门文章失败:",m),d.value="获取推荐文章失败，请稍后重试"}finally{n.value=!1}};return S(()=>{l()}),(m,i)=>{const _=h("el-loading-spinner"),v=h("el-button"),C=h("router-link"),e=h("el-card"),t=h("el-empty");return r(),c("div",lt,[i[2]||(i[2]=o("h2",null,"热门推荐",-1)),n.value?(r(),c("div",it,[u(_)])):R("",!0),d.value?(r(),c("div",ct,[$(w(d.value)+" ",1),u(v,{type:"text",onClick:l},{default:k(()=>i[0]||(i[0]=[$("重试")])),_:1,__:[0]})])):s.value.length>0?(r(),c("div",ut,[(r(!0),c(D,null,B(s.value,a=>(r(),A(L,{key:a.article_id,"image-url":a.cover_image||"https://picsum.photos/400/300",title:a.title,excerpt:a.summary||"暂无简介","author-name":a.username,"author-avatar":a.avatar_url,category:a.type,likes:a.likes_count,comments:a.comments_count,onClick:f=>m.$emit("article-click",a.article_id)},null,8,["image-url","title","excerpt","author-name","author-avatar","category","likes","comments","onClick"]))),128)),u(e,{class:"more-article-tip"},{default:k(()=>[o("h3",null,[u(C,{to:"/forum"},{default:k(()=>i[1]||(i[1]=[$("查看更多")])),_:1,__:[1]})])]),_:1})])):(r(),A(t,{key:3,description:"暂无推荐文章数据"}))])}}}),mt=b(dt,[["__scopeId","data-v-036c6c1d"]]),pt=T({__name:"Index",setup(x){const s=F(),d=(()=>{const v=new Date,C=v.getFullYear(),e=String(v.getMonth()+1).padStart(2,"0"),t=String(v.getDate()).padStart(2,"0");return`${C}年${e}月${t}日`})(),y=()=>s.push("/login"),l=()=>s.push("/cookbooks/create"),m=v=>{s.push(`/forum/article/${v}`)},i=()=>s.push("/cookbooks"),_=()=>s.push("/forum");return(v,C)=>(r(),c(D,null,[u(P),o("main",null,[u(J,{onGoToCookbooks:i,onGoToForum:_}),u(X),u(rt,{"current-date":H(d),onGoToLogin:y,onGoToCreateRecipe:l,onArticleClick:m},null,8,["current-date"]),u(mt,{onArticleClick:m})])],64))}}),yt=b(pt,[["__scopeId","data-v-c2588b61"]]);export{yt as default};
