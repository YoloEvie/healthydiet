import{_ as F}from"./home-AI-C5OKNaV-.js";import{a as T}from"./axios-NIGUFBhG.js";import{_ as N,u as A}from"./index-CMQRH6kX.js";import{r as d,t as L,k as h,e as u,o as m,g as t,f as e,j as r,y as i,u as _,L as p,F as P,M as V,G as k}from"./element-plus-DirRqt2a.js";const Y="/assets/mine-xiaoxi-DV33oro2.png",j="/assets/mine-article-DYilE0KO.png",G="/assets/mine-good-DBvT_BOB.png",O={class:"personal-information"},U={class:"left"},$=["src"],K={key:1,src:"https://p3.hippopx.com/preview/723/720/forests-mist-autumn-colors-peaceful-forest-vibrant-autumn-soft-daylight-nature-s-beauty-misty-forest-autumn-forest-natural-scenery.jpg",alt:"默认头像"},R={class:"right"},q={class:"name-box"},z={class:"number"},H={class:"other"},J={class:"age"},Q={class:"sex"},W={class:"action-area card"},X={class:"personal-icon icon"},Z={class:"customer-service set"},ee={class:"customer-service-icon icon"},se={class:"feedback-icon icon"},te={__name:"PersonalCenter",setup(oe){const c=A(),n=d({}),g=d(!0),f=d(""),x=()=>{const o=localStorage.getItem("user_id");return o?o.replace(/^"/,"").replace(/"$/,""):null},y=o=>({male:"男",female:"女"})[o]||"未设置",b=o=>{if(!o)return"未设置";try{const s=new Date(o);if(isNaN(s.getTime()))return"重新设置年龄";const a=new Date;let l=a.getFullYear()-s.getFullYear();const v=a.getMonth()-s.getMonth();return(v<0||v===0&&a.getDate()<s.getDate())&&l--,l>=0?l+"岁":"重新设置年龄"}catch(s){return console.error("计算年龄出错:",s),"重新设置年龄"}},C=async()=>{const o=x();if(!o){f.value="未找到用户信息，请先登录",g.value=!1;return}try{const s=await T.get(`http://localhost:3000/api/users/${o}`);n.value=s.data}catch(s){console.error("获取用户信息失败:",s),f.value="获取用户信息失败，请稍后重试"}finally{g.value=!1}},I=()=>{c.push("/mine/personalset")},B=()=>{V.confirm("确定要退出登录吗？","退出确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{w(),k.success("已成功退出登录")}).catch(()=>{k.info("已取消退出")})},M=()=>{c.push("/mine/feedback")},w=()=>{localStorage.removeItem("role"),localStorage.removeItem("user_id"),localStorage.removeItem("username"),c.push("/")},D=()=>{c.push("/mine/message")},E=()=>{c.push("/mine/post")},S=()=>{c.push("/mine/like")};return L(()=>{C()}),(o,s)=>{const a=h("el-card"),l=h("el-icon");return m(),u(P,null,[t(a,{class:"card"},{default:r(()=>[e("div",O,[e("div",U,[n.value.avatar_url?(m(),u("img",{key:0,src:n.value.avatar_url,alt:"用户头像",class:"avatar"},null,8,$)):(m(),u("img",K))]),e("div",R,[e("div",q,[e("p",null,"用户名："+i(n.value.username||"未设置"),1)]),e("div",z,[e("p",null,"账号："+i(n.value.phone_number||"未知"),1)]),e("div",H,[e("p",J,"年龄："+i(b(n.value.birth_date)),1),e("p",Q,"性别："+i(y(n.value.gender)),1)])])])]),_:1}),e("div",W,[t(a,{class:"action-card",onClick:o.handleEditAI},{default:r(()=>s[0]||(s[0]=[e("div",{class:"action-item"},[e("div",{class:"card-img"},[e("img",{src:F,alt:""})]),e("h2",null,"AI营养师")],-1)])),_:1,__:[0]},8,["onClick"]),t(a,{class:"action-card",onClick:D},{default:r(()=>s[1]||(s[1]=[e("div",{class:"action-item"},[e("div",{class:"card-img"},[e("img",{src:Y,alt:""})]),e("h2",null,"消息通知")],-1)])),_:1,__:[1]}),t(a,{class:"action-card",onClick:E},{default:r(()=>s[2]||(s[2]=[e("div",{class:"action-item"},[e("div",{class:"card-img"},[e("img",{src:j,alt:""})]),e("h2",null,"我的帖子")],-1)])),_:1,__:[2]}),t(a,{class:"action-card",onClick:S},{default:r(()=>s[3]||(s[3]=[e("div",{class:"action-item"},[e("div",{class:"card-img"},[e("img",{src:G,alt:""})]),e("h2",null,"我的喜欢")],-1)])),_:1,__:[3]})]),t(a,{class:"card"},{default:r(()=>[e("div",{class:"personal-setting set",onClick:I},[s[4]||(s[4]=e("p",{class:"personal-text"},"账号设置",-1)),e("div",X,[t(l,null,{default:r(()=>[t(_(p),{color:"var(--el-text-color-primary)"})]),_:1})])]),e("div",Z,[s[5]||(s[5]=e("p",{class:"customer-service-text"},"智能客服",-1)),e("div",ee,[t(l,null,{default:r(()=>[t(_(p),{color:"var(--el-text-color-primary)"})]),_:1})])]),e("div",{class:"feedback set",onClick:M,style:{border:"0"}},[s[6]||(s[6]=e("p",{class:"feedback-text"},"建议与反馈",-1)),e("div",se,[t(l,null,{default:r(()=>[t(_(p),{color:"var(--el-text-color-primary)"})]),_:1})])])]),_:1}),t(a,{class:"card out",onClick:B},{default:r(()=>s[7]||(s[7]=[e("p",{class:"out-text"},"退出登录",-1)])),_:1,__:[7]})],64)}}},ce=N(te,[["__scopeId","data-v-0e3cdbdd"]]);export{ce as default};
