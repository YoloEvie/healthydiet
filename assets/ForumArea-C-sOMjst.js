import{d as $,r as v,c as q,v as j,w as z,e as i,f as c,g as _,j as V,l as h,k as y,J as E,u as L,K as M,L as R,x as d,y as g,z as k,F as S,A as D,H,o as r}from"./element-plus-BAXMo5c4.js";import{a as I,u as J,_ as O}from"./index-bPO5O26h.js";import{A as Q}from"./ArticleCard-CPeb8u_b.js";import{a as T}from"./axios-NIGUFBhG.js";const U={class:"main"},G={id:"header"},P={class:"add-container"},W={class:"search-container"},X={class:"articles-container"},Y={key:0,class:"search-result"},Z={class:"search-text"},ee={class:"count"},te={key:1,class:"articles-grid"},se={key:4,class:"loading"},ae={key:5,class:"error-message"},oe=$({__name:"ForumArea",setup(re){const p=J(),l=I(),a=v(""),C=v([]),u=v(!0),n=v(""),f=q(()=>a.value.trim().length>0),m=q(()=>{const e=a.value.trim().toLowerCase(),t=C.value.filter(o=>o.status==="published");return e?t.filter(o=>o.title.toLowerCase().includes(e)||o.summary&&o.summary.toLowerCase().includes(e)||o.username.toLowerCase().includes(e)):t}),b=async()=>{try{u.value=!0;const e=await T.get("http://localhost:3000/api/articles");C.value=e.data,n.value=""}catch(e){console.error("获取文章失败:",e),n.value="获取文章列表失败，请稍后重试"}finally{u.value=!1}};j(()=>{l.query.search&&typeof l.query.search=="string"&&(a.value=l.query.search),b()}),z(()=>l.query.search,e=>{typeof e=="string"?a.value=e:e===void 0&&(a.value="")});const x=()=>{const e=a.value.trim();p.push({path:l.path,query:{...l.query,search:e||void 0}})},w=()=>{a.value="";const{search:e,...t}=l.query;p.push({path:l.path,query:Object.keys(t).length?t:void 0}),H.success("已清除搜索条件")},B=()=>{p.push("/new_article")},F=e=>{p.push(`/forum/article/${e}`)};return(e,t)=>{const o=y("el-button"),N=y("el-input"),A=y("el-empty"),K=y("el-loading-spinner");return r(),i("div",U,[c("header",G,[c("div",P,[_(o,{type:"primary",onClick:B},{default:V(()=>t[2]||(t[2]=[h("发布")])),_:1,__:[2]})]),c("div",W,[_(N,{modelValue:a.value,"onUpdate:modelValue":t[0]||(t[0]=s=>a.value=s),style:{width:"240px"},placeholder:"查找食谱","suffix-icon":a.value?L(M):L(R),"onClick:suffix":t[1]||(t[1]=s=>a.value?w:x),onKeyup:E(x,["enter"])},null,8,["modelValue","suffix-icon"])])]),c("main",X,[f.value&&!u.value&&!n.value?(r(),i("div",Y,[c("div",Z,[t[3]||(t[3]=h(" 搜索到 ")),c("span",ee,k(m.value.length),1),h(' 条关于 "'+k(a.value)+'" 的结果 ',1)]),_(o,{type:"success",size:"small",onClick:w},{default:V(()=>t[4]||(t[4]=[h(" 清除搜索 ")])),_:1,__:[4]})])):d("",!0),!u.value&&!n.value&&m.value.length>0?(r(),i("div",te,[(r(!0),i(S,null,D(m.value,s=>(r(),g(Q,{class:"article-card",key:s.article_id,"image-url":s.cover_image||"https://picsum.photos/400/300",title:s.title,excerpt:s.summary||"暂无简介","author-name":s.username,"author-avatar":s.avatar_url,category:s.type,likes:s.likes_count,comments:s.comments_count,onClick:le=>F(s.article_id)},null,8,["image-url","title","excerpt","author-name","author-avatar","category","likes","comments","onClick"]))),128))])):d("",!0),!u.value&&!n.value&&m.value.length===0&&f.value?(r(),g(A,{key:2,description:"未找到匹配的食谱文章"})):d("",!0),!u.value&&!n.value&&m.value.length===0&&!f.value?(r(),g(A,{key:3,description:"暂无食谱文章数据"})):d("",!0),u.value?(r(),i("div",se,[_(K)])):d("",!0),n.value?(r(),i("div",ae,k(n.value),1)):d("",!0)])])}}}),de=O(oe,[["__scopeId","data-v-2716492d"]]);export{de as default};
